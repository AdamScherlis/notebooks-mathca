(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42379,       1176]
NotebookOptionsPosition[     39000,       1116]
NotebookOutlinePosition[     39336,       1131]
CellTagsIndexPosition[     39293,       1128]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/", 
              RowBox[{"(", 
               RowBox[{"Total", "/@", "#"}], ")"}]}], ")"}], "*", 
            RowBox[{"(", "#", ")"}]}], "]"}], "]"}], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "[", "#", "]"}], ".", 
           RowBox[{"Total", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], 
     "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "]"}], 
        "\[Equal]", "1"}], ")"}], "&&", 
      RowBox[{"Fold", "[", 
       RowBox[{"And", ",", 
        RowBox[{
         RowBox[{
          RowBox[{".001", "\[LessEqual]", "#", "\[LessEqual]", ".999"}], 
          "&"}], "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
       "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7644685815337257`*^9, 3.764468583695979*^9}, {
   3.7644687285663548`*^9, 3.764468804248221*^9}, 3.764468836755027*^9, {
   3.7644690270755243`*^9, 3.7644690279514027`*^9}, {3.764469075776411*^9, 
   3.7644690783688383`*^9}, 3.764469109744585*^9, {3.7644708115683737`*^9, 
   3.7644708260043173`*^9}, {3.7644708738344727`*^9, 3.764470972820569*^9}, {
   3.764471033378324*^9, 3.7644710789420347`*^9}, {3.764471125234804*^9, 
   3.764471149555951*^9}, {3.764471247393084*^9, 3.764471248819825*^9}, {
   3.764471287528604*^9, 3.7644713186030827`*^9}, {3.764471389490665*^9, 
   3.764471391296224*^9}},
 CellLabel->
  "In[592]:=",ExpressionUUID->"4d335a44-397a-4e00-af1f-1fc1f6f3ed3e"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.764471164240025*^9, 3.76447125117128*^9, 
  3.764471296793481*^9, 3.764471335165259*^9, 3.7644713956010942`*^9},
 CellLabel->
  "Out[593]=",ExpressionUUID->"0fa221b5-21d1-4984-a928-5ac45ef995c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.764470840644079*^9, 3.764470851276649*^9}},
 CellLabel->
  "In[567]:=",ExpressionUUID->"11ee0eb3-380e-40d3-9e75-0fa24ad59efc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "2"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "3"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "4"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "2"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "3"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "4"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "1"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "2"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "3"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "4"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "1"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "2"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "3"}], "]"}], ",", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "4"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7644708517064743`*^9},
 CellLabel->
  "Out[567]=",ExpressionUUID->"1989a6d1-2ab4-41ec-a89a-387f35bb977b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fold", "[", 
  RowBox[{"And", ",", 
   RowBox[{
    RowBox[{
     RowBox[{".001", "\[LessEqual]", "#", "\[LessEqual]", ".999"}], "&"}], "/@", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}]}], 
  "]"}]], "Input",
 CellLabel->
  "In[573]:=",ExpressionUUID->"8fd2c13f-7659-4ffb-82aa-ded5a45b1bc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "4"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "3"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "4"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "3"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "4"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "1"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "2"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "3"}], "]"}], "\[LessEqual]", "0.999`"}], "&&", 
  RowBox[{"0.001`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "4"}], "]"}], "\[LessEqual]", "0.999`"}]}]], "Output",
 CellChangeTimes->{3.7644710877781878`*^9},
 CellLabel->
  "Out[573]=",ExpressionUUID->"3449c7ef-5ea4-4db0-8228-c0439c3ff2ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "]"}], 
    "\[Equal]", "1"}], ")"}], "&&", 
  RowBox[{"Fold", "[", 
   RowBox[{"And", ",", 
    RowBox[{
     RowBox[{
      RowBox[{".01", "\[LessEqual]", "#", "\[LessEqual]", ".99"}], "&"}], "/@", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.764471352303985*^9, 3.7644713563169518`*^9}},
 CellLabel->
  "In[591]:=",ExpressionUUID->"f164ecca-ae7f-4fc1-88ec-f7d97c9b7619"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"1", ",", "2"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"1", ",", "3"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"1", ",", "4"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"2", ",", "3"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"2", ",", "4"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"3", ",", "1"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"3", ",", "2"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"3", ",", "3"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"3", ",", "4"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"4", ",", "1"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"4", ",", "2"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"4", ",", "3"}], "]"}], "+", 
    RowBox[{"a", "[", 
     RowBox[{"4", ",", "4"}], "]"}]}], "\[Equal]", "1"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "3"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"1", ",", "4"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "1"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "3"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"2", ",", "4"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "1"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "3"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"3", ",", "4"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "1"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "2"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "3"}], "]"}], "\[LessEqual]", "0.99`"}], "&&", 
  RowBox[{"0.01`", "\[LessEqual]", 
   RowBox[{"a", "[", 
    RowBox[{"4", ",", "4"}], "]"}], "\[LessEqual]", "0.99`"}]}]], "Output",
 CellChangeTimes->{3.764471356786907*^9},
 CellLabel->
  "Out[591]=",ExpressionUUID->"d42b7e9e-ad72-4f0d-b19e-32dc0ff5b05a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "/", 
               RowBox[{"(", 
                RowBox[{"Total", "/@", "#"}], ")"}]}], ")"}], "*", 
             RowBox[{"(", "#", ")"}]}], "]"}], "]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", "#", "]"}], ".", 
            RowBox[{"Total", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"10", "^", "6"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], 
           "]"}], "-", "1"}], ")"}], "^", "2"}]}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{"And", ",", 
       RowBox[{
        RowBox[{
         RowBox[{".001", "\[LessEqual]", "#", "\[LessEqual]", ".999"}], "&"}],
         "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
      "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.76447146586749*^9, 3.764471483199237*^9}, {
  3.7644715183536177`*^9, 3.76447153105869*^9}, {3.7644716978184557`*^9, 
  3.7644716988081627`*^9}},
 CellLabel->
  "In[619]:=",ExpressionUUID->"73904051-7a93-4a96-b739-5c3bb768deac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3.291358736668905`*^-8"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "0.026693017709885743`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0.00376707839864309`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "0.05978503798225892`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "4"}], "]"}], "\[Rule]", "0.027406101509634927`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0.04038149688773467`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "0.005703164901859204`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "0.09044161816571444`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "4"}], "]"}], "\[Rule]", "0.04146019427376997`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "0.144839737481641`"}], ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "0.020434838846596304`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "0.3243652697341983`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "4"}], "]"}], "\[Rule]", "0.14870779042285842`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "0.01497752810609398`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "0.002115584902608906`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "0.033543883492980014`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "0.015377834148105625`"}]}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.76447148717237*^9, {3.764471522195036*^9, 3.764471539005299*^9}, 
   3.764471701477034*^9},
 CellLabel->
  "Out[619]=",ExpressionUUID->"5446bd91-60ce-4045-b763-cb9aadde1bf6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "/.", 
  RowBox[{"%598", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"Total", "[", "%", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.1599338271448913`", ",", "0.001`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.001`", ",", "0.001`", ",", 
     RowBox[{"0.16251174448983646`", "+", 
      RowBox[{"(", "1.", ")"}], "-", "1.0004827973458748`"}], ",", "0.001`"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.002978816592504808`", ",", "0.0029987919658148684`", ",", 
     "0.500549419887716`", ",", "0.002978869248014006`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.15953132801709718`", ",", "0.001`"}], 
    "}"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"Total", "[", 
  RowBox[{"Total", "[", "%", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "/", 
          RowBox[{"(", 
           RowBox[{"Total", "/@", "#"}], ")"}]}], ")"}], "*", 
        RowBox[{"(", "#", ")"}]}], "]"}], "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", "#", "]"}], ".", 
       RowBox[{"Total", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], "[", "%%", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.764471498157168*^9, 3.764471501723545*^9}, {
  3.764471551145084*^9, 3.7644716118025217`*^9}, {3.764471665030774*^9, 
  3.764471671577142*^9}},
 CellLabel->
  "In[614]:=",ExpressionUUID->"a411a714-e31a-49e6-aacb-22225e8f26a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.1599338271448913`", ",", "0.001`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.16251174448983646`", ",", "0.001`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.002978816592504808`", ",", "0.0029987919658148684`", ",", 
     "0.500549419887716`", ",", "0.002978869248014006`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.15953132801709718`", ",", "0.001`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.7644716722306013`*^9}},
 CellLabel->
  "Out[614]=",ExpressionUUID->"ded69f63-5c6b-4359-8383-49e8c3def390"],

Cell[BoxData["1.0004827973458748`"], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.764471672234778*^9}},
 CellLabel->
  "Out[615]=",ExpressionUUID->"7484e2f4-a7ef-46bf-8ac6-1cc2a931a72f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.1599338271448913`", ",", "0.001`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.16202894714396177`", ",", "0.001`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.002978816592504808`", ",", "0.0029987919658148684`", ",", 
     "0.500549419887716`", ",", "0.002978869248014006`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.001`", ",", "0.15953132801709718`", ",", "0.001`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.764471672237932*^9}},
 CellLabel->
  "Out[616]=",ExpressionUUID->"2c0389cd-242c-4065-bfca-2887c7beb5e7"],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.764471672241521*^9}},
 CellLabel->
  "Out[617]=",ExpressionUUID->"6c069514-8bc0-4d56-8a50-f34ba155a6f9"],

Cell[BoxData["2.0769819075727725`*^-7"], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.764471672244911*^9}},
 CellLabel->
  "Out[618]=",ExpressionUUID->"5a2fff4e-2c18-4ce4-b90d-24a4d44de5f7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "/.", 
  RowBox[{"%619", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"1", "-", 
  RowBox[{"Total", "[", 
   RowBox[{"Total", "[", "%", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%%", "+", 
  RowBox[{"%", "/", "16"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Total", "[", "%", "]"}], "]"}], "-", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "/", 
          RowBox[{"(", 
           RowBox[{"Total", "/@", "#"}], ")"}]}], ")"}], "*", 
        RowBox[{"(", "#", ")"}]}], "]"}], "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", "#", "]"}], ".", 
       RowBox[{"Total", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], "[", "%%", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.764471498157168*^9, 3.764471501723545*^9}, {
  3.764471551145084*^9, 3.7644716118025217`*^9}, {3.764471665030774*^9, 
  3.764471671577142*^9}, {3.764471725674192*^9, 3.764471805368451*^9}},
 CellLabel->
  "In[644]:=",ExpressionUUID->"3302e056-b168-46d7-8361-6c5ae6b23597"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.026693017709885743`", ",", "0.00376707839864309`", ",", 
     "0.05978503798225892`", ",", "0.027406101509634927`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04038149688773467`", ",", "0.005703164901859204`", ",", 
     "0.09044161816571444`", ",", "0.04146019427376997`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.144839737481641`", ",", "0.020434838846596304`", ",", 
     "0.3243652697341983`", ",", "0.14870779042285842`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.01497752810609398`", ",", "0.002115584902608906`", ",", 
     "0.033543883492980014`", ",", "0.015377834148105625`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.7644716722306013`*^9}, {
   3.764471728412827*^9, 3.764471747408395*^9}, {3.76447178356085*^9, 
   3.7644718057466793`*^9}},
 CellLabel->
  "Out[644]=",ExpressionUUID->"616db3f7-f73b-4e3e-86c3-12313343854b"],

Cell[BoxData[
 RowBox[{"-", "1.76964583431527`*^-7"}]], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.7644716722306013`*^9}, {
   3.764471728412827*^9, 3.764471747408395*^9}, {3.76447178356085*^9, 
   3.7644718057504263`*^9}},
 CellLabel->
  "Out[645]=",ExpressionUUID->"e789adc5-b1a5-4a58-8a42-274bcb1373ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.02669300664959928`", ",", "0.0037670673383566255`", ",", 
     "0.059785026921972455`", ",", "0.027406090449348462`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.04038148582744821`", ",", "0.005703153841572739`", ",", 
     "0.09044160710542798`", ",", "0.041460183213483506`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.14483972642135454`", ",", "0.02043482778630984`", ",", 
     "0.32436525867391186`", ",", "0.14870777936257196`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.014977517045807515`", ",", "0.0021155738423224413`", ",", 
     "0.03354387243269355`", ",", "0.01537782308781916`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.7644716722306013`*^9}, {
   3.764471728412827*^9, 3.764471747408395*^9}, {3.76447178356085*^9, 
   3.764471805753798*^9}},
 CellLabel->
  "Out[646]=",ExpressionUUID->"73a7596c-cca2-4061-bc29-b1b89a87428b"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.7644716722306013`*^9}, {
   3.764471728412827*^9, 3.764471747408395*^9}, {3.76447178356085*^9, 
   3.7644718057569237`*^9}},
 CellLabel->
  "Out[647]=",ExpressionUUID->"5e4693a2-9aad-4573-9a90-9944f477e30c"],

Cell[BoxData["3.5692054867197953`*^-10"], "Output",
 CellChangeTimes->{
  3.764471502001993*^9, {3.764471555386307*^9, 3.764471579436075*^9}, 
   3.764471612404252*^9, {3.76447166579978*^9, 3.7644716722306013`*^9}, {
   3.764471728412827*^9, 3.764471747408395*^9}, {3.76447178356085*^9, 
   3.7644718057601223`*^9}},
 CellLabel->
  "Out[648]=",ExpressionUUID->"ceb422c0-68be-4431-b378-84eeba94109b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Total", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "/", 
               RowBox[{"(", 
                RowBox[{"Total", "/@", "#"}], ")"}]}], ")"}], "*", 
             RowBox[{"(", "#", ")"}]}], "]"}], "]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Total", "[", "#", "]"}], ".", 
            RowBox[{"Total", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"i", ",", "j"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"10", "^", "3"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Total", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}], 
           "]"}], "-", "1"}], ")"}], "^", "2"}]}]}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Fold", "[", 
      RowBox[{"And", ",", 
       RowBox[{
        RowBox[{
         RowBox[{".001", "\[LessEqual]", "#", "\[LessEqual]", ".999"}], "&"}],
         "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"a", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}]}], 
      "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mr", "=", 
   RowBox[{"%", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.764471498157168*^9, 3.764471501723545*^9}, {
  3.764471551145084*^9, 3.7644716118025217`*^9}, {3.764471665030774*^9, 
  3.764471671577142*^9}, {3.764471833152403*^9, 3.764471885619151*^9}, {
  3.764472001871023*^9, 3.7644720474061317`*^9}},
 CellLabel->
  "In[679]:=",ExpressionUUID->"923d5f5e-5a80-42a7-b4e9-52083ce5df04"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.00005353809647280554`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "\[Rule]", "0.0017952945517754632`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "2"}], "]"}], "\[Rule]", "0.004679089902746485`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "3"}], "]"}], "\[Rule]", "0.0017629655619285874`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "4"}], "]"}], "\[Rule]", "0.05583373431623357`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"1", ",", "5"}], "]"}], "\[Rule]", "0.0822627792040403`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "0.001`"}], ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "\[Rule]", "0.002565964667682684`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "3"}], "]"}], "\[Rule]", "0.001`"}], ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "4"}], "]"}], "\[Rule]", "0.03068646466650569`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"2", ",", "5"}], "]"}], "\[Rule]", "0.04525985735444868`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "1"}], "]"}], "\[Rule]", "0.0030773291543620806`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "2"}], "]"}], "\[Rule]", "0.00808209336708857`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "\[Rule]", "0.003073320595827775`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "4"}], "]"}], "\[Rule]", "0.09700476959897064`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"3", ",", "5"}], "]"}], "\[Rule]", "0.14292521196089375`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "1"}], "]"}], "\[Rule]", "0.005328821381041736`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "2"}], "]"}], "\[Rule]", "0.014020163829108256`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "3"}], "]"}], "\[Rule]", "0.0053063924910201985`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "0.16743262469107956`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"4", ",", "5"}], "]"}], "\[Rule]", "0.24686492200424645`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"5", ",", "1"}], "]"}], "\[Rule]", "0.001`"}], ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"5", ",", "2"}], "]"}], "\[Rule]", "0.0025514985102578114`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"5", ",", "3"}], "]"}], "\[Rule]", "0.001`"}], ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"5", ",", "4"}], "]"}], "\[Rule]", "0.03061859151616039`"}], 
     ",", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"5", ",", "5"}], "]"}], "\[Rule]", "0.04509972163863669`"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.764471858502541*^9, 3.7644718953964567`*^9}, 
   3.764472010048203*^9, {3.7644720421771717`*^9, 3.764472068927148*^9}},
 CellLabel->
  "Out[680]=",ExpressionUUID->"b186cc9f-0e7b-416c-a34a-3af4a3c968d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "n"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}], "/.", 
  "mr"}], "\[IndentingNewLine]", 
 RowBox[{"1", "-", 
  RowBox[{"Total", "[", 
   RowBox[{"Total", "[", "%", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%%", "+", 
  RowBox[{"%", "/", 
   RowBox[{"n", "^", "2"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Total", "[", 
   RowBox[{"Total", "[", "%", "]"}], "]"}], "-", "1"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"#", "/", 
          RowBox[{"(", 
           RowBox[{"Total", "/@", "#"}], ")"}]}], ")"}], "*", 
        RowBox[{"(", "#", ")"}]}], "]"}], "]"}], "-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Total", "[", "#", "]"}], ".", 
       RowBox[{"Total", "[", "#", "]"}]}], ")"}]}], ")"}], "&"}], "[", "%%", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.764471907679091*^9, 3.764471921393086*^9}, {
  3.764472015069216*^9, 3.7644720155005007`*^9}, {3.764472052953576*^9, 
  3.764472053083333*^9}},
 CellLabel->
  "In[682]:=",ExpressionUUID->"5ce6af6e-bb02-4cf1-aa42-85350de6290f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.0017952945517754632`", ",", "0.004679089902746485`", ",", 
     "0.0017629655619285874`", ",", "0.05583373431623357`", ",", 
     "0.0822627792040403`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.002565964667682684`", ",", "0.001`", ",", 
     "0.03068646466650569`", ",", "0.04525985735444868`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0030773291543620806`", ",", "0.00808209336708857`", ",", 
     "0.003073320595827775`", ",", "0.09700476959897064`", ",", 
     "0.14292521196089375`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.005328821381041736`", ",", "0.014020163829108256`", ",", 
     "0.0053063924910201985`", ",", "0.16743262469107956`", ",", 
     "0.24686492200424645`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.001`", ",", "0.0025514985102578114`", ",", "0.001`", ",", 
     "0.03061859151616039`", ",", "0.04509972163863669`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.764471908945527*^9, 3.7644719222269573`*^9}, {
   3.764471992386278*^9, 3.7644720163153133`*^9}, 3.7644720706032887`*^9},
 CellLabel->
  "Out[682]=",ExpressionUUID->"43414476-43c2-4841-9712-b4256cafe0c1"],

Cell[BoxData[
 RowBox[{"-", "0.0002316109640554398`"}]], "Output",
 CellChangeTimes->{{3.764471908945527*^9, 3.7644719222269573`*^9}, {
   3.764471992386278*^9, 3.7644720163153133`*^9}, 3.7644720706075773`*^9},
 CellLabel->
  "Out[683]=",ExpressionUUID->"9811df63-f607-4966-b86e-17c53df7db51"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.0017860301132132457`", ",", "0.004669825464184267`", ",", 
     "0.00175370112336637`", ",", "0.055824469877671354`", ",", 
     "0.08225351476547808`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0009907355614377825`", ",", "0.0025567002291204664`", ",", 
     "0.0009907355614377825`", ",", "0.030677200227943475`", ",", 
     "0.04525059291588646`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.003068064715799863`", ",", "0.008072828928526352`", ",", 
     "0.0030640561572655577`", ",", "0.09699550516040842`", ",", 
     "0.14291594752233153`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.005319556942479518`", ",", "0.014010899390546038`", ",", 
     "0.005297128052457981`", ",", "0.16742336025251733`", ",", 
     "0.24685565756568423`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.0009907355614377825`", ",", "0.002542234071695594`", ",", 
     "0.0009907355614377825`", ",", "0.030609327077598173`", ",", 
     "0.04509045720007447`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.764471908945527*^9, 3.7644719222269573`*^9}, {
   3.764471992386278*^9, 3.7644720163153133`*^9}, 3.7644720706122026`*^9},
 CellLabel->
  "Out[684]=",ExpressionUUID->"98c25038-8aa0-4914-b9f6-5e37ef94f2d6"],

Cell[BoxData[
 RowBox[{"-", "1.1102230246251565`*^-16"}]], "Output",
 CellChangeTimes->{{3.764471908945527*^9, 3.7644719222269573`*^9}, {
   3.764471992386278*^9, 3.7644720163153133`*^9}, 3.764472070617098*^9},
 CellLabel->
  "Out[685]=",ExpressionUUID->"df5a8598-7f6a-47b6-a881-a6edd3162741"],

Cell[BoxData["5.442742695427327`*^-8"], "Output",
 CellChangeTimes->{{3.764471908945527*^9, 3.7644719222269573`*^9}, {
   3.764471992386278*^9, 3.7644720163153133`*^9}, 3.764472070621297*^9},
 CellLabel->
  "Out[686]=",ExpressionUUID->"13a6930c-0c5f-4162-b235-c2faf0dc4eb1"]
}, Open  ]]
},
WindowSize->{808, 621},
WindowMargins->{{Automatic, 159}, {-34, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 3186, 82, 216, "Input",ExpressionUUID->"4d335a44-397a-4e00-af1f-1fc1f6f3ed3e"],
Cell[3769, 106, 252, 4, 35, "Output",ExpressionUUID->"0fa221b5-21d1-4984-a928-5ac45ef995c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4058, 115, 453, 12, 31, "Input",ExpressionUUID->"11ee0eb3-380e-40d3-9e75-0fa24ad59efc"],
Cell[4514, 129, 1204, 37, 59, "Output",ExpressionUUID->"1989a6d1-2ab4-41ec-a89a-387f35bb977b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5755, 171, 581, 17, 31, "Input",ExpressionUUID->"8fd2c13f-7659-4ffb-82aa-ded5a45b1bc2"],
Cell[6339, 190, 2236, 52, 151, "Output",ExpressionUUID->"3449c7ef-5ea4-4db0-8228-c0439c3ff2ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8612, 247, 1091, 32, 55, "Input",ExpressionUUID->"f164ecca-ae7f-4fc1-88ec-f7d97c9b7619"],
Cell[9706, 281, 3303, 86, 174, "Output",ExpressionUUID->"d42b7e9e-ad72-4f0d-b19e-32dc0ff5b05a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13046, 372, 2767, 77, 193, "Input",ExpressionUUID->"73904051-7a93-4a96-b739-5c3bb768deac"],
Cell[15816, 451, 2370, 73, 134, "Output",ExpressionUUID->"5446bd91-60ce-4045-b763-cb9aadde1bf6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18223, 529, 1956, 56, 193, "Input",ExpressionUUID->"a411a714-e31a-49e6-aacb-22225e8f26a2"],
Cell[20182, 587, 836, 23, 59, "Output",ExpressionUUID->"ded69f63-5c6b-4359-8383-49e8c3def390"],
Cell[21021, 612, 291, 5, 35, "Output",ExpressionUUID->"7484e2f4-a7ef-46bf-8ac6-1cc2a931a72f"],
Cell[21315, 619, 834, 23, 59, "Output",ExpressionUUID->"2c0389cd-242c-4065-bfca-2887c7beb5e7"],
Cell[22152, 644, 275, 5, 35, "Output",ExpressionUUID->"6c069514-8bc0-4d56-8a50-f34ba155a6f9"],
Cell[22430, 651, 295, 5, 37, "Output",ExpressionUUID->"5a2fff4e-2c18-4ce4-b90d-24a4d44de5f7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22762, 661, 1459, 41, 124, "Input",ExpressionUUID->"3302e056-b168-46d7-8361-6c5ae6b23597"],
Cell[24224, 704, 1072, 26, 105, "Output",ExpressionUUID->"616db3f7-f73b-4e3e-86c3-12313343854b"],
Cell[25299, 732, 413, 8, 37, "Output",ExpressionUUID->"e789adc5-b1a5-4a58-8a42-274bcb1373ef"],
Cell[25715, 742, 1075, 26, 105, "Output",ExpressionUUID->"73a7596c-cca2-4061-bc29-b1b89a87428b"],
Cell[26793, 770, 378, 7, 35, "Output",ExpressionUUID->"5e4693a2-9aad-4573-9a90-9944f477e30c"],
Cell[27174, 779, 399, 7, 37, "Output",ExpressionUUID->"ceb422c0-68be-4431-b378-84eeba94109b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27610, 791, 3055, 84, 239, "Input",ExpressionUUID->"923d5f5e-5a80-42a7-b4e9-52083ce5df04"],
Cell[30668, 877, 3476, 105, 174, "Output",ExpressionUUID->"b186cc9f-0e7b-416c-a34a-3af4a3c968d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34181, 987, 1385, 41, 124, "Input",ExpressionUUID->"5ce6af6e-bb02-4cf1-aa42-85350de6290f"],
Cell[35569, 1030, 1234, 30, 128, "Output",ExpressionUUID->"43414476-43c2-4841-9712-b4256cafe0c1"],
Cell[36806, 1062, 293, 5, 35, "Output",ExpressionUUID->"9811df63-f607-4966-b86e-17c53df7db51"],
Cell[37102, 1069, 1309, 31, 128, "Output",ExpressionUUID->"98c25038-8aa0-4914-b9f6-5e37ef94f2d6"],
Cell[38414, 1102, 293, 5, 37, "Output",ExpressionUUID->"df5a8598-7f6a-47b6-a881-a6edd3162741"],
Cell[38710, 1109, 274, 4, 70, "Output",ExpressionUUID->"13a6930c-0c5f-4162-b235-c2faf0dc4eb1"]
}, Open  ]]
}
]
*)

